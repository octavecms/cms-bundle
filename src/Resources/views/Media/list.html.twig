{% extends 'SonataAdminBundle::standard_layout.html.twig' %}

{% import 'VideInfraCMSBundle:Media:treeview.html.twig' as tree %}
{% import 'VideInfraCMSBundle:Media:gridlist.html.twig' as gridlist %}
{% import 'VideInfraCMSBundle:Media:filters.html.twig' as filters %}

{% block body_attributes %}data-widget="media" {{ parent() }}{% endblock %}

{% block sonata_page_content_header %}
    {{ filters.filters() }}
{% endblock %}


{% block content %}

    <div class="row">
        <div class="col-xs-6 col-md-3">
            {{ tree.navigate_child([root_category], admin, true, current_category_id, 1) }}
        </div>
        <div class="col-xs-12 col-md-9">
            {% set selectmode = false %}
            {{ gridlist.list(selectmode) }}
        </div>
    </div>

{% endblock %}


{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="{{ asset('bundles/videinfracms/media/dist/main.css') }}" />
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        var API_ENDPOINTS = {
            'folderAdd':    '{{ path('media_category_add') }}',
            'folderRemove': '{{ path('media_category_remove') }}',
            'folderMove':   '/bundles/videinfracms/media/json/folder-move.json',
            'filesList':    '{{ path('media_item_list') }}',
            'filesReplace': '{{ path('media_item_replace') }}',
            'filesUpload':  '{{ path('media_item_upload') }}',
            'filesRemove':  '{{ path('media_item_remove') }}',
            'filesMove':    '{{ path('media_item_move') }}',
        };

        var MEDIA_INITIAL_STATE = {
            'tree': {
                'root': {{ root_category|json_encode|raw }}
            },
            'categoryId': {{ current_category_id|default(root_category.id)|json_encode|raw }}
        };
    </script>
    <script src="{{ asset('bundles/videinfracms/media/dist/main.js') }}"></script>
{% endblock %}